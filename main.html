<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title data-translate="pageTitle">ุงูุฎุจูุฑ ุงููุญุงุณุจู</title>
<link rel="stylesheet" href="main.css">
<script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='90' height='90' x='5' y='5' fill='%230a6efd' rx='15'/><text y='68' x='50' font-size='60' fill='white' text-anchor='middle' font-weight='bold'>+</text><circle cx='75' cy='25' r='20' fill='%23198754'/><text y='34' x='75' font-size='30' fill='white' text-anchor='middle' font-weight='bold'>โ</text></svg>">

  
</head>
<body>
<div class="wrap">
  <div class="card">
    <div class="no-print">
      <div class="header-controls">
        <h1 data-translate="pageTitle" style="text-align: initial;">ุงูุฎุจูุฑ ุงููุญุงุณุจู</h1>
        <div class="header-buttons">
          <span id="welcomeUser" class="welcome-user"></span>
          <button class="btn secondary" id="langToggleBtn">English</button>
          <button class="btn danger" id="logoutBtn" data-translate="logoutBtn">ุชุณุฌูู ุงูุฎุฑูุฌ</button>
        </div>
      </div>

      <div class="tabs-nav">
        <button class="tab-btn active" data-tab="invoiceTab" data-translate="invoiceTab">ูุงุชูุฑุฉ ุถุฑูุจูุฉ</button>
        <button class="tab-btn" data-tab="receiptTab" data-translate="receiptTab">ุณูุฏ ุชุญุตูู</button>
        <button class="tab-btn" data-tab="itemsTab" data-translate="itemsTab">ุงูุฃุตูุงู</button>
        <button class="tab-btn" data-tab="customersTab" data-translate="customersTab">ุงูุนููุงุก</button>
        <button class="tab-btn" data-tab="settingsTab" data-translate="settingsTab">ุงูุฅุนุฏุงุฏุงุช ูุงูุจูุงูุงุช</button>
      </div>

      <!-- Main Invoice Tab -->
      <div id="invoiceTab" class="tab-content active">
        <div class="sub-tabs-nav">
          <button class="sub-tab-btn active" data-tab="createInvoice" data-parent="invoiceTab" data-translate="createInvoiceSubTab">ุฅูุดุงุก ูุงุชูุฑุฉ</button>
          <button class="sub-tab-btn" data-tab="invoiceLog" data-parent="invoiceTab" data-translate="invoiceLogSubTab">ุณุฌู ุงูููุงุชูุฑ</button>
        </div>
        <div id="createInvoice" class="sub-tab-content active">
          <div class="actions">
            <button class="btn" id="newInvoiceBtn" data-translate="newInvoiceBtn">โ ุฌุฏูุฏ</button>
            <button class="btn success" id="generateBtn" data-translate="generateBtn">๐พ ุญูุธ</button>
            <button class="btn secondary" id="printInvoiceBtn" data-translate="printBtn">๐จ๏ธ ุทุจุงุนุฉ</button>
          </div>
                  <div class="form-section">
            <h2 data-translate="invoiceAndCustomerData">ุจูุงูุงุช ุงููุงุชูุฑุฉ ูุงูุนููู</h2>
            <!-- ุงูุตู ุงูุฃูู ูุจูู ููุง ูู ูุฃูู ูุญุชูู ุนูู ุญูููู -->
            <div class="row">
              <div class="col"><label for="invoiceNumber" data-translate="invoiceNumber">ุฑูู ุงููุงุชูุฑุฉ</label><input id="invoiceNumber" type="text"></div>
              <div class="col"><label for="invoiceDate" data-translate="invoiceDate">ุชุงุฑูุฎ ุงููุงุชูุฑุฉ</label><input id="invoiceDate" type="datetime-local"></div>
            </div>
            <!-- ุงูุตู ุงูุซุงูู ูุจูู ููุง ูู -->
            <div class="row">
              <div class="col customer-col">
                <label for="customerName" data-translate="customerName">ุงุณู ุงูุนููู</label>
                <input id="customerName" type="text" list="customersDatalist" data-translate-placeholder="customerNamePlaceholder">
                <span id="customerBalanceDisplay" class="customer-balance-display"></span>
              </div>
              <div class="col"><label for="customerTaxNumber" data-translate="customerTaxNumber">ุงูุฑูู ุงูุถุฑูุจู ููุนููู</label><input id="customerTaxNumber" type="text" readonly></div>
            </div>
          </div>
          <div class="form-section">
            <h2 style="margin-bottom:0" data-translate="items">ุงูุฃุตูุงู</h2>
            <table class="items-table" id="itemsTable">
                <thead><tr><th style="width:40%" data-translate="itemDescription">ุงููุตู</th><th data-translate="itemQty">ุงููููุฉ</th><th data-translate="itemUnitPrice">ุณุนุฑ ุงููุญุฏุฉ</th><th data-translate="itemTotal">ุงูุฅุฌูุงูู</th><th style="width:70px" data-translate="itemAction">ุฅุฌุฑุงุก</th></tr></thead>
                <tbody id="itemsBody"></tbody>
            </table>
            <div style="margin-top:8px" class="controls"><button class="btn" id="addItemBtn" data-translate="addItemBtn">โ ุฅุถุงูุฉ ุตูู</button></div>
            <div class="summary">
              <p><span data-translate="subTotalLabel">ุงูุฅุฌูุงูู ูุจู ุงูุถุฑูุจุฉ:</span> <strong id="subTotal">0.00</strong> SAR</p>
              <p><span data-translate="vatTotalLabel">ูููุฉ ุงูุถุฑูุจุฉ (15%):</span> <strong id="vatTotal">0.00</strong> SAR</p>
              <p><span data-translate="grandTotalLabel">ุงูุฅุฌูุงูู ุงูููู:</span> <strong id="grandTotal">0.00</strong> SAR</p>
            </div>
          </div>
        </div>
        <div id="invoiceLog" class="sub-tab-content"><h2 data-translate="invoiceLogTitle">ุณุฌู ุงูููุงุชูุฑ</h2><table class="log-table" id="invoiceLogTable"><thead><tr><th data-translate="logInvoiceNumber">ุฑูู ุงููุงุชูุฑุฉ</th><th data-translate="logDate">ุงูุชุงุฑูุฎ</th><th data-translate="logCustomer">ุงูุนููู</th><th data-translate="logTotal">ุงูุฅุฌูุงูู</th><th data-translate="logActions">ุฅุฌุฑุงุกุงุช</th></tr></thead><tbody id="invoiceLogBody"></tbody></table></div>
      </div>

      <!-- Main Receipt Tab -->
      <div id="receiptTab" class="tab-content">
        <div class="sub-tabs-nav">
          <button class="sub-tab-btn active" data-tab="createReceipt" data-parent="receiptTab" data-translate="createReceiptSubTab">ุฅูุดุงุก ุณูุฏ</button>
          <button class="sub-tab-btn" data-tab="receiptLog" data-parent="receiptTab" data-translate="receiptLogSubTab">ุณุฌู ุงูุณูุฏุงุช</button>
        </div>
        <div id="createReceipt" class="sub-tab-content active">
          <h1 data-translate="salesReceiptVoucher">ุณูุฏ ุชุญุตูู ูุจูุนุงุช</h1>
           <div class="actions">
            <button class="btn" id="newReceiptBtn" data-translate="newReceiptBtn">โ ุฌุฏูุฏ</button>
            <button class="btn success" id="saveReceiptBtn" data-translate="saveReceiptBtn">๐พ ุญูุธ ุงูุณูุฏ</button>
            <button class="btn secondary" id="printReceiptBtn" data-translate="printReceiptBtn">๐จ๏ธ ุทุจุงุนุฉ ุงูุณูุฏ</button>
          </div>
          <div class="form-section">
            <h2 data-translate="voucherData">ุจูุงูุงุช ุงูุณูุฏ</h2>
            <div class="row"><div class="col"><label for="receiptNumber" data-translate="receiptNumber">ุฑูู ุงูุณูุฏ</label><input id="receiptNumber" type="text"></div><div class="col"><label for="receiptDate" data-translate="receiptDate">ุชุงุฑูุฎ ุงูุณูุฏ</label><input id="receiptDate" type="datetime-local"></div></div>
          </div>
          <div class="form-section">
            <h2 data-translate="customerAndCollectionData">ุจูุงูุงุช ุงูุนููู ูุงูุชุญุตูู</h2>
             <div class="row">
                <div class="col customer-col">
                  <label for="receiptCustomerName" data-translate="receiptCustomerName">ุงุณู ุงูุนููู</label>
                  <input id="receiptCustomerName" type="text" list="customersDatalist" data-translate-placeholder="receiptCustomerNamePlaceholder">
                  <span id="receiptCustomerBalanceDisplay" class="customer-balance-display"></span>
                </div>
                <div class="col"><label for="amountReceived" data-translate="amountReceived">ุงููุจูุบ ุงููุณุชูู</label><input id="amountReceived" type="number" min="0" step="any" placeholder="0.00"></div>
             </div>
             <div class="row" style="margin-top:8px"><div class="col"><label for="paymentMethod" data-translate="paymentMethod">ุทุฑููุฉ ุงูุฏูุน</label><select id="paymentMethod"><option value="Cash" data-translate="paymentCash">ููุฏู</option><option value="Bank Transfer" data-translate="paymentBank">ุชุญููู ุจููู</option><option value="Credit Card" data-translate="paymentCard">ุจุทุงูุฉ ุงุฆุชูุงู</option></select></div></div>
          </div>
          <div class="form-section"><h2 data-translate="description">ุงููุตู</h2><div class="row"><div class="col"><label for="receiptDescription" data-translate="receiptDescriptionLabel">ูุตู ุนูููุฉ ุงูุชุญุตูู</label><textarea id="receiptDescription" data-translate-placeholder="receiptDescriptionPlaceholder"></textarea></div></div></div>
        </div>
        <div id="receiptLog" class="sub-tab-content"><h2 data-translate="receiptLogTitle">ุณุฌู ุณูุฏุงุช ุงูุชุญุตูู</h2><table class="log-table" id="receiptLogTable"><thead><tr><th data-translate="logReceiptNumber">ุฑูู ุงูุณูุฏ</th><th data-translate="logDate">ุงูุชุงุฑูุฎ</th><th data-translate="logCustomer">ุงูุนููู</th><th data-translate="logAmount">ุงููุจูุบ</th><th data-translate="logActions">ุฅุฌุฑุงุกุงุช</th></tr></thead><tbody id="receiptLogBody"></tbody></table></div>
      </div>

      <!-- Items Management Tab -->
      <div id="itemsTab" class="tab-content">
        <div class="sub-tabs-nav"><button class="sub-tab-btn active" data-tab="createItem" data-parent="itemsTab" data-translate="createItemSubTab">ุฅูุดุงุก ุตูู</button><button class="sub-tab-btn" data-tab="itemLog" data-parent="itemsTab" data-translate="itemLogSubTab">ุณุฌู ุงูุฃุตูุงู</button></div>
        <div id="createItem" class="sub-tab-content active"><h2 data-translate="addNewItem">ุฅุถุงูุฉ/ุชุนุฏูู ุตูู</h2><div class="row"><div class="col"><label for="itemName" data-translate="itemName">ุงุณู/ูุตู ุงูุตูู</label><input id="itemName" type="text"></div><div class="col"><label for="itemPrice" data-translate="itemPrice">ุณุนุฑ ุงููุญุฏุฉ</label><input id="itemPrice" type="number" min="0" step="any"></div></div><div class="actions" style="margin-top: 16px;"><button class="btn success" id="saveItemBtn" data-translate="saveItemBtn">๐พ ุญูุธ ุงูุตูู</button><button class="btn secondary" id="clearItemFormBtn" data-translate="clearFormBtn">โ ุฌุฏูุฏ</button></div></div>
        <div id="itemLog" class="sub-tab-content"><h2 data-translate="savedItems">ุงูุฃุตูุงู ุงููุญููุธุฉ</h2><table class="log-table" id="itemsLogTable"><thead><tr><th data-translate="itemName">ุงุณู ุงูุตูู</th><th data-translate="itemPrice">ุงูุณุนุฑ</th><th data-translate="qtySold">ุงููููุฉ ุงููุจุงุนุฉ</th><th data-translate="logActions">ุฅุฌุฑุงุกุงุช</th></tr></thead><tbody id="itemsLogBody"></tbody></table></div>
      </div>
      
      <!-- Customers Management Tab -->
      <div id="customersTab" class="tab-content">
        <div class="sub-tabs-nav"><button class="sub-tab-btn active" data-tab="createCustomer" data-parent="customersTab" data-translate="createCustomerSubTab">ุฅูุดุงุก ุนููู</button><button class="sub-tab-btn" data-tab="customerLog" data-parent="customersTab" data-translate="customerLogSubTab">ุณุฌู ุงูุนููุงุก</button></div>
        <div id="createCustomer" class="sub-tab-content active">
            <h2 data-translate="addNewCustomer">ุฅุถุงูุฉ/ุชุนุฏูู ุนููู</h2>
            <div class="row"><div class="col"><label for="custCode" data-translate="customerCode">ููุฏ ุงูุนููู</label><input id="custCode" type="text"></div><div class="col"><label for="custName" data-translate="customerName">ุงุณู ุงูุนููู</label><input id="custName" type="text"></div><div class="col"><label for="custTaxNumber" data-translate="customerTaxNumber">ุงูุฑูู ุงูุถุฑูุจู</label><input id="custTaxNumber" type="text"></div></div>
            <div class="row" style="margin-top:8px"><div class="col"><label for="custCrNumber" data-translate="crNumber">ุฑูู ุงูุณุฌู ุงูุชุฌุงุฑู</label><input id="custCrNumber" type="text"></div><div class="col"><label for="custNationalId" data-translate="nationalId">ุฑูู ุงููููุฉ</label><input id="custNationalId" type="text"></div><div class="col"><label for="custPhone" data-translate="phone">ุฑูู ุงููุงุชู</label><input id="custPhone" type="text"></div></div>
                       <h3 data-translate="nationalAddress">ุงูุนููุงู ุงููุทูู</h3>
            <div class="form-grid">
                <div class="col"><label for="custCity" data-translate="city">ุงููุฏููุฉ</label><input id="custCity" type="text"></div>
                <div class="col"><label for="custDistrict" data-translate="district">ุงูุญู</label><input id="custDistrict" type="text"></div>
                <div class="col"><label for="custStreet" data-translate="street">ุงูุดุงุฑุน</label><input id="custStreet" type="text"></div>
                <div class="col"><label for="custPostalCode" data-translate="postalCode">ุงูุฑูุฒ ุงูุจุฑูุฏู</label><input id="custPostalCode" type="text" maxlength="5" oninput="this.value = this.value.replace(/[^0-9]/g, '')"></div>
                <div class="col"><label for="custBuildingNumber" data-translate="buildingNumber">ุฑูู ุงููุจูู</label><input id="custBuildingNumber" type="text" maxlength="4" oninput="this.value = this.value.replace(/[^0-9]/g, '')"></div>
                <div class="col"><label for="custAdditionalNumber" data-translate="additionalNumber">ุงูุฑูู ุงูุฅุถุงูู</label><input id="custAdditionalNumber" type="text" maxlength="4" oninput="this.value = this.value.replace(/[^0-9]/g, '')"></div>
            </div>
            <div class="actions" style="margin-top: 16px;"><button class="btn success" id="saveCustomerBtn" data-translate="saveCustomerBtn">๐พ ุญูุธ ุงูุนููู</button><button class="btn secondary" id="clearCustomerFormBtn" data-translate="clearFormBtn">โ ุฌุฏูุฏ</button></div>
        </div>
        <div id="customerLog" class="sub-tab-content"><h2 data-translate="savedCustomers">ุงูุนููุงุก ุงููุญููุธูู</h2><table class="log-table" id="customersLogTable"><thead><tr><th data-translate="customerCode">ุงูููุฏ</th><th data-translate="customerName">ุงุณู ุงูุนููู</th><th data-translate="phone">ุงููุงุชู</th><th data-translate="balance">ุงูุฑุตูุฏ</th><th data-translate="logActions">ุฅุฌุฑุงุกุงุช</th></tr></thead><tbody id="customersLogBody"></tbody></table></div>
      </div>
      
      <!-- Settings Tab -->
      <div id="settingsTab" class="tab-content">
        <h1 data-translate="settingsTab">ุงูุฅุนุฏุงุฏุงุช ูุงูุจูุงูุงุช</h1>
        <div class="form-section"><h2 data-translate="companySection">ุจูุงูุงุช ุงูุดุฑูุฉ</h2><p class="small" data-translate="companySectionHint">ูุฐู ุงูุจูุงูุงุช ุณุชุธูุฑ ูู ุฃุนูู ุงูููุงุชูุฑ ูุงูุณูุฏุงุช ุงููุทุจูุนุฉ.</p><div class="row"><div class="col"><label for="settingSellerName" data-translate="sellerName">ุงุณู ุงูุดุฑูุฉ</label><input id="settingSellerName" type="text"></div><div class="col"><label for="settingSellerTaxNum" data-translate="sellerTaxNumber">ุงูุฑูู ุงูุถุฑูุจู</label><input id="settingSellerTaxNum" type="text"></div></div><div class="row" style="margin-top:8px"><div class="col"><label for="settingSellerPhone" data-translate="phone">ุงููุงุชู</label><input id="settingSellerPhone" type="text"></div><div class="col"><label for="settingSellerAddress" data-translate="sellerAddress">ุงูุนููุงู</label><input id="settingSellerAddress" type="text"></div></div><div class="actions" style="margin-top: 16px;"><button class="btn success" id="saveSettingsBtn" data-translate="saveSettingsBtn">๐พ ุญูุธ ุงูุฅุนุฏุงุฏุงุช</button></div></div>
        <div class="form-section"><h2 data-translate="databaseManagement">ุฅุฏุงุฑุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช</h2><p class="small" data-translate="databaseManagementHint">ููููู ุฃุฎุฐ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ูู ุจูุงูุงุชู ูู ูููุ ุฃู ุงุณุชุนุงุฏุฉ ุงูุจูุงูุงุช ูู ูุณุฎุฉ ุณุงุจูุฉ. ุงูุจูุงูุงุช ุชุญูุธ ุชููุงุฆูุงู ูู ุงููุชุตูุญ.</p><div class="actions"><button class="btn" id="exportAllBtn" data-translate="exportAllBtn">๐พ ุชุตุฏูุฑ ูุณุฎุฉ ุงุญุชูุงุทูุฉ</button><div><label for="importAllFile" class="btn secondary" data-translate="importAllBtn">๐ ุงุณุชุนุงุฏุฉ ูู ููู</label><input type="file" id="importAllFile" accept=".xlsx, .xls" style="display:none;"></div><button class="btn danger" id="clearAllDataBtn" data-translate="clearAllDataBtn">๐๏ธ ูุณุญ ูู ุงูุจูุงูุงุช (ุฎุทุฑ)</button></div></div>
      </div>
      
      <datalist id="customersDatalist"></datalist>
      <datalist id="itemsDatalist"></datalist>
    </div>

    <!-- Preview Areas -->
    <div class="preview invoice-preview" id="invoicePreview">
        <div class="inv-header"><div class="seller-block"><h2 id="previewSellerName"></h2><div id="previewSellerInfo" class="small"></div></div><div class="qr-block"><div id="qrContainer"></div><div class="small" style="margin-top:6px" data-translate="qrScan">ุงูุณุญ QR ููุชุญูู</div></div></div>
        <h1 class="invoice-title" id="invoiceTitle"></h1>
        <div id="previewClient" class="preview-client-details"></div>
        <div class="preview-meta"><div class="meta-item"><div class="small" data-translate="previewInvoiceNo">ูุงุชูุฑุฉ ุฑูู:</div><div id="previewInvoiceNo" class="meta-value"></div></div><div class="meta-item"><div class="small" data-translate="previewDate">ุงูุชุงุฑูุฎ:</div><div id="previewDate" class="meta-value"></div></div></div>
        <div id="previewItems" class="preview-items-container"></div><div id="previewTotals" class="preview-totals-container"></div><footer class="small" data-translate="thankYou">ุดูุฑุง ููู</footer>
    </div>
    <div class="preview receipt-preview" id="receiptPreview">
        <div class="receipt-header"><h2 id="receiptPreviewSellerName"></h2><div class="small" id="receiptPreviewSellerInfo"></div></div>
        <h1 class="receipt-title" data-translate="receiptVoucherTitle">ุณูุฏ ุชุญุตูู</h1>
        <table class="receipt-details-table">
            <tbody>
                <tr><td class="receipt-label" data-translate="previewReceiptNumber">ุฑูู ุงูุณูุฏ:</td><td id="receiptPreviewNumber"></td></tr>
                <tr><td class="receipt-label" data-translate="previewDate">ุงูุชุงุฑูุฎ:</td><td id="receiptPreviewDate"></td></tr>
                <tr><td class="receipt-label" data-translate="previewReceivedFrom">ุงุณุชูููุง ูู ุงูุณูุฏ/ุงูุณุงุฏุฉ:</td><td id="receiptPreviewCustomer"></td></tr>
                <tr><td class="receipt-label" data-translate="previewAmount">ูุจูุบ ููุฏุฑู:</td><td id="receiptPreviewAmount"></td></tr>
                <tr><td class="receipt-label" data-translate="previewFor">ูุฐูู ุนู:</td><td id="receiptPreviewDesc"></td></tr>
                <tr><td class="receipt-label" data-translate="previewPaymentMethod">ุทุฑููุฉ ุงูุฏูุน:</td><td id="receiptPreviewPayment"></td></tr>
            </tbody>
        </table>
        <div class="receipt-signatures"><div><strong data-translate="signatureReceiver">ุงููุณุชูู: ....................</strong></div><div><strong data-translate="signatureStamp">ุงูุฎุชู:</strong></div></div>
    </div>
    <div class="statement-preview" id="statementPreview">
        <div class="statement-header"><h2 id="statementSellerName"></h2><div class="small" id="statementSellerInfo"></div><h1 style="margin-top: 20px;" data-translate="accountStatementTitle">ูุดู ุญุณุงุจ ุนููู</h1></div>
        <div id="statementClientInfo" class="statement-client-info"></div>
        <table class="log-table" id="statementTable"><thead><tr><th data-translate="logDate">ุงูุชุงุฑูุฎ</th><th data-translate="statementTransaction">ุงูุญุฑูุฉ</th><th data-translate="statementDebit">ูุฏูู</th><th data-translate="statementCredit">ุฏุงุฆู</th><th data-translate="balance">ุงูุฑุตูุฏ</th></tr></thead><tbody id="statementTableBody"></tbody></table>
        <div id="statementSummary" class="statement-summary"></div>
    </div>
  </div>
</div>
<script src="main.js"></script>
</body>
</html>
